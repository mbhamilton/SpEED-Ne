The SpEED-Ne/SpEED-Ne simulation code/ folder contains the Matlab code for simulations and manipulation of simulated data filed. The simulation functions use the estimation code functions that are found in SpEED-Ne/SpEED-Ne interface code/.

simulate_r.m - Program designed as a simulator that calls functions to estimate r_squared_comp and r_squared_delta using simulated data. 
This function utilizes the same estimation functions as the GUI version of SpEED-Ne along with generate_pop.m to simulate genetic data with a time-forward algorithm.

simulate_nulls_r.m - Program designed as a simulator that calls functions to estimate r_squared_comp and r_squared_delta using simulated data. This function utilizes the same estimation functions as the GUI version of SpEED-Ne along with generate_pop.m to simulate genetic data with a time-forward algorithm. Null alleles are simulated by calling sim_null_alleles.m after simulated data is generated. 

_r_fsc.m - Program designed as a simulator that calls functions to estimate r_squared_comp and r_squared_delta using simulated data. This function utilizes the same estimation functions as the GUI version of SpEED-Ne. This version uses simulated data files generated by fastsimcoal in arlequin format read with function read_arp.m.

generate_pop.m - Function to generate a sample of diploid genotypes from a population with known effective population size. All loci have the same number of alleles, all alleles have equal initial frequencies, and initial allelic states are adjacent integers. Used by simulate_r.m. 

sim_null_alleles.m - Given a data set of diploid genotypes, the function will sample one allele at random with a frequency ≤ max_freq_null at each locus. All heterozygous genotypes containing the null allele are altered to be homozygous for the non-null allele and all genotypes homozygous for the null allele were re-coded as missing data. If a locus has no alleles ≤ pnull the locus is skipped. Used by simulate_nulls_r.m. 

read_arp.m - Function to read simulated genetic data in arlequin format and export it as simple two columns per locus format. Used by simulate_r_fsc.m. 
